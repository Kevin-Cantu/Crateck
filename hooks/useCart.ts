\"use client\";\nimport { useState, useMemo, useCallback } from \"react\";\nimport { EquipmentItem, CartItem, CartActions, CartState } from \"@/types/equipment\";\n\nexport const useCart = (): CartState & CartActions => {\n  const [cart, setCart] = useState<CartItem[]>([]);\n\n  // Memoized calculations\n  const totalItems = useMemo(() => \n    cart.reduce((sum, item) => sum + item.quantity, 0), \n    [cart]\n  );\n\n  const totalPrice = useMemo(() => \n    cart.reduce((total, item) => total + (item.price * item.quantity), 0), \n    [cart]\n  );\n\n  // Memoized cart actions\n  const addToCart = useCallback((equipment: EquipmentItem) => {\n    setCart(prev => {\n      const existingItem = prev.find(item => item.id === equipment.id);\n      if (existingItem) {\n        return prev.map(item =>\n          item.id === equipment.id\n            ? { ...item, quantity: item.quantity + 1 }\n            : item\n        );\n      }\n      return [...prev, { ...equipment, quantity: 1 }];\n    });\n  }, []);\n\n  const updateQuantity = useCallback((id: string, change: number) => {\n    setCart(prev => \n      prev.map(item => {\n        if (item.id === id) {\n          const newQuantity = item.quantity + change;\n          return newQuantity > 0 ? { ...item, quantity: newQuantity } : item;\n        }\n        return item;\n      }).filter(item => item.quantity > 0)\n    );\n  }, []);\n\n  const removeFromCart = useCallback((id: string) => {\n    setCart(prev => prev.filter(item => item.id !== id));\n  }, []);\n\n  const clearCart = useCallback(() => {\n    setCart([]);\n  }, []);\n\n  const sendWhatsAppMessage = useCallback(() => {\n    if (cart.length === 0) return;\n\n    const message = `¡Hola! Me interesa rentar el siguiente equipo de Crateck:\n\n${cart.map(item => \n  `• ${item.name} (${item.code})\n  Cantidad: ${item.quantity} ${item.unit}${item.quantity > 1 ? 'S' : ''}\n  Subtotal: $${(item.price * item.quantity).toLocaleString()}`\n).join('\\n\\n')}\n\nTOTAL ESTIMADO: $${totalPrice.toLocaleString()}\n\n¿Podrían proporcionarme más información sobre disponibilidad y condiciones de renta?\n\nGracias.`;\n\n    const encodedMessage = encodeURIComponent(message);\n    const whatsappUrl = `https://wa.me/528131295300?text=${encodedMessage}`;\n    window.open(whatsappUrl, '_blank');\n  }, [cart, totalPrice]);\n\n  return {\n    items: cart,\n    totalItems,\n    totalPrice,\n    addToCart,\n    updateQuantity,\n    removeFromCart,\n    clearCart,\n    sendWhatsAppMessage,\n  };\n};\n